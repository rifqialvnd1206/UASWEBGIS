const gunung = [
  {
    nama: "Gunung Tangkuban Parahu",
    koordinat: [-6.758926599340126, 107.60975881367207],
    gambar: "asset/tangkubanparahu.jpg",
    deskripsi: "Gunung Tangkuban Parahu (2.084 mdpl) - Lembang",
    lokasi: "Kecamatan Lembang, Kabupaten Bandung Barat, Jawa Barat",
    tinggi: "2.084 mdpl",
    tingkat: "Level I (Normal)",
    tipeAktivitas: "Tipe A",
    tipeBentuk: "Strato",
    letusan: "2 Agustus 2019",
    latitude: -6.758926599340126,
    longitude: 107.60975881367207,
    link: "https://id.wikipedia.org/wiki/Gunung_Tangkuban_Parahu"
  },
  {
    nama: "Gunung Burangrang",
    koordinat: [-6.7729969551098845, 107.55582279792323],
    gambar: "asset/burangrang.jpg",
    deskripsi: "Gunung Burangrang (2.064 mdpl) - Barat Lembang",
    lokasi: "Kecamatan Cisarua, Kabupaten Bandung Barat, Jawa Barat",
    tinggi: "2.064 mdpl",
    tingkat: "Level I (Normal)",
    tipeAktivitas: "Tipe B",
    tipeBentuk: "Strato",
    letusan: "Tidak diketahui",
    latitude: -6.7729969551098845,
    longitude: 107.55582279792323,
    link: "https://id.wikipedia.org/wiki/Gunung_Burangrang"
  },
  {
    nama: "Gunung Manglayang",
    koordinat: [-6.875130885467591, 107.74391145131727],
    gambar: "asset/manglayang.jpg",
    deskripsi: "Gunung Manglayang (1.818 mdpl) - Timur Bandung",
    lokasi: "Perbatasan Kabupaten Bandung dan Kabupaten Sumedang, Jawa Barat",
    tinggi: "1.818 mdpl",
    tingkat: "Level I (Normal)",
    tipeAktivitas: "Tipe B",
    tipeBentuk: "Strato",
    letusan: "Tidak tercatat",
    latitude: -6.875130885467591,
    longitude: 107.74391145131727,
    link: "https://id.wikipedia.org/wiki/Gunung_Manglayang"
  },
  {
    nama: "Gunung Palasari",
    koordinat: [-6.840963960622953, 107.73333918891242],
    gambar: "asset/palasari.jpg",
    deskripsi: "Gunung Palasari (1.728 mdpl) - Cimahi Utara",
    lokasi: "Kecamatan Cimahi Utara, Kota Cimahi, Jawa Barat",
    tinggi: "1.728 mdpl",
    tingkat: "Level I (Normal)",
    tipeAktivitas: "Tipe B",
    tipeBentuk: "Strato",
    letusan: "Tidak diketahui",
    latitude: -6.840963960622953,
    longitude: 107.73333918891242,
    link: "https://id.wikipedia.org/wiki/Gunung_Palasari"
  },
  {
    nama: "Gunung Malabar",
    koordinat: [-7.128955482076105, 107.63814137465434],
    gambar: "asset/malabar.jpg",
    deskripsi: "Gunung Malabar (2.343 mdpl) - Selatan Bandung",
    lokasi: "Kecamatan Pangalengan, Kabupaten Bandung, Jawa Barat",
    tinggi: "2.343 mdpl",
    tingkat: "Level I (Normal)",
    tipeAktivitas: "Tipe B",
    tipeBentuk: "Strato",
    letusan: "Tidak diketahui",
    latitude: -7.128955482076105,
    longitude: 107.63814137465434,
    link: "https://id.wikipedia.org/wiki/Gunung_Malabar"
  },
  {
    nama: "Gunung Puntang",
    koordinat: [-7.120366662075966, 107.62128270533697],
    gambar: "asset/puntang.jpg",
    deskripsi: "Gunung Puntang (~2.223 mdpl) - Kawasan Malabar",
    lokasi: "Kecamatan Cimaung, Kabupaten Bandung, Jawa Barat",
    tinggi: "~2.223 mdpl",
    tingkat: "Level I (Normal)",
    tipeAktivitas: "Tipe B",
    tipeBentuk: "Strato",
    letusan: "Tidak diketahui",
    latitude: -7.120366662075966,
    longitude: 107.62128270533697,
    link: "https://id.wikipedia.org/wiki/Gunung_Puntang"
  },
  {
    nama: "Gunung Patuha",
    koordinat: [-7.160664765312184, 107.40015129739713],
    gambar: "asset/patuha.jpg",
    deskripsi: "Gunung Patuha (2.434 mdpl) - Ciwidey",
    lokasi: "Kecamatan Rancabali, Kabupaten Bandung, Jawa Barat",
    tinggi: "2.434 mdpl",
    tingkat: "Level I (Normal)",
    tipeAktivitas: "Tipe B",
    tipeBentuk: "Strato",
    letusan: "Tidak diketahui",
    latitude: -7.160664765312184,
    longitude: 107.40015129739713,
    link: "https://id.wikipedia.org/wiki/Gunung_Patuha"
  },
  {
    nama: "Gunung Tilu",
    koordinat: [-7.155451851945098, 107.52918685192256],
    gambar: "asset/tilu.jpg",
    deskripsi: "Gunung Tilu (~1.840 mdpl) - Pangalengan",
    lokasi: "Kecamatan Pangalengan, Kabupaten Bandung, Jawa Barat",
    tinggi: "~1.840 mdpl",
    tingkat: "Level I (Normal)",
    tipeAktivitas: "Tipe B",
    tipeBentuk: "Strato",
    letusan: "Tidak diketahui",
    latitude: -7.155451851945098,
    longitude: 107.52918685192256,
    link: "https://id.wikipedia.org/wiki/Gunung_Tilu"
  },
  {
    nama: "Gunung Rakutak",
    koordinat: [-7.14686100733948, 107.73399498260513],
    gambar: "asset/rakutak.jpg",
    deskripsi: "Gunung Rakutak (1.925 mdpl) - Ciparay",
    lokasi: "Kecamatan Ciparay, Kabupaten Bandung, Jawa Barat",
    tinggi: "1.925 mdpl",
    tingkat: "Level I (Normal)",
    tipeAktivitas: "Tipe B",
    tipeBentuk: "Strato",
    letusan: "Tidak tercatat",
    latitude: -7.14686100733948,
    longitude: 107.73399498260513,
    link: "https://id.wikipedia.org/wiki/Gunung_Rakutak"
  },
  {
    nama: "Gunung Wayang",
    koordinat: [-7.21198469648666, 107.6366954625649],
    gambar: "asset/wayang.jpg",
    deskripsi: "Gunung Wayang (2.182 mdpl) - Kamojang",
    lokasi: "Perbatasan Kabupaten Bandung dan Garut, Jawa Barat",
    tinggi: "2.182 mdpl",
    tingkat: "Level I (Normal)",
    tipeAktivitas: "Tipe B",
    tipeBentuk: "Strato",
    letusan: "Tidak diketahui",
    latitude: -7.21198469648666,
    longitude: 107.6366954625649,
    link: "https://id.wikipedia.org/wiki/Gunung_Wayang"
  },
  {
    nama: "Gunung Windu",
    koordinat: [-7.223479979399424, 107.63049265841393],
    gambar: "asset/windu.jpg",
    deskripsi: "Gunung Windu (2.095 mdpl) - Selatan Wayang",
    lokasi: "Kecamatan Pangalengan, Kabupaten Bandung, Jawa Barat",
    tinggi: "2.095 mdpl",
    tingkat: "Level I (Normal)",
    tipeAktivitas: "Tipe B",
    tipeBentuk: "Strato",
    letusan: "Tidak diketahui",
    latitude: -7.223479979399424,
    longitude: 107.63049265841393,
    link: "https://id.wikipedia.org/wiki/Gunung_Windu"
  },
  {
    nama: "Gunung Bukit Tunggul",
    koordinat: [-6.810939386648984, 107.72690387367469],
    gambar: "asset/bukittunggul.jpg",
    deskripsi: "Gunung Bukit Tunggul (~2.200 mdpl) - Lembang Utara",
    lokasi: "Kecamatan Cilengkrang, Kabupaten Bandung, Jawa Barat",
    tinggi: "~2.200 mdpl",
    tingkat: "Level I (Normal)",
    tipeAktivitas: "Tipe B",
    tipeBentuk: "Strato",
    letusan: "Tidak diketahui",
    latitude: -6.810939386648984,
    longitude: 107.72690387367469,
    link: "https://id.wikipedia.org/wiki/Gunung_Bukit_Tunggul"
  },
  {
    nama: "Gunung Hawu",
    koordinat: [-6.834210665799698, 107.46062106665173],
    gambar: "asset/hawu.jpg",
    deskripsi: "Gunung Hawu (~1.200 mdpl) - Padalarang",
    lokasi: "Kecamatan Padalarang, Kabupaten Bandung Barat, Jawa Barat",
    tinggi: "~1.200 mdpl",
    tingkat: "Level I (Normal)",
    tipeAktivitas: "Karst / Bukit kapur",
    tipeBentuk: "Non-vulkanik",
    letusan: "-",
    latitude: -6.834210665799698,
    longitude: 107.46062106665173,
    link: "https://id.wikipedia.org/wiki/Gunung_Hawu"
  },
  {
    nama: "Gunung Batu",
    koordinat: [-6.8300886285399685, 107.63622601174299],
    gambar: "asset/batu.jpg",
    deskripsi: "Gunung Batu (~1.228 mdpl) - Lembang",
    lokasi: "Kecamatan Lembang, Kabupaten Bandung Barat, Jawa Barat",
    tinggi: "~1.228 mdpl",
    tingkat: "Level I (Normal)",
    tipeAktivitas: "Tipe B",
    tipeBentuk: "Strato",
    letusan: "Tidak diketahui",
    latitude: -6.8300886285399685,
    longitude: 107.63622601174299,
    link: "https://id.wikipedia.org/wiki/Gunung_Batu,_Lembang"
  }
];

const map = L.map('map', {
  center: [-7.1, 107.6],
  zoom: 10
});

const osm = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
  attribution: '© OpenStreetMap'
}).addTo(map);

const esri = L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}', {
  attribution: 'Tiles © Esri'
});

const baseMaps = {
  "OpenStreetMap": osm,
  "ESRI Satellite": esri
};

L.control.layers(baseMaps).addTo(map);

gunung.forEach(g => {
  const popupContent = `
    <div class="popup-full">
      <img src="${g.gambar}" alt="${g.nama}">
      <table>
        <tr><td><strong>Nama Gunung</strong></td><td>${g.nama}</td></tr>
        <tr><td><strong>Lokasi</strong></td><td>${g.lokasi}</td></tr>
        <tr><td><strong>Tingkat Keaktifan</strong></td><td>${g.tingkat}</td></tr>
        <tr><td><strong>Tinggi Gunung</strong></td><td>${g.tinggi}</td></tr>
        <tr><td><strong>Tipe Gunung Api</strong></td><td>${g.tipeAktivitas}</td></tr>
        <tr><td><strong>Bentuk Gunung</strong></td><td>${g.tipeBentuk}</td></tr>
        <tr><td><strong>Letusan Terakhir</strong></td><td>${g.letusan}</td></tr>
        <tr><td><strong>Latitude</strong></td><td>${g.latitude}</td></tr>
        <tr><td><strong>Longitude</strong></td><td>${g.longitude}</td></tr>
      </table>
    </div>
  `;

  L.marker(g.koordinat).addTo(map).bindPopup(popupContent);
});

function showPage(pageId) {
  const pages = document.querySelectorAll('.page');
  pages.forEach(p => {
    p.classList.remove('active');
    p.style.display = 'none';
  });

  const target = document.getElementById(pageId);
  if (target) {
    target.style.display = 'block';
    setTimeout(() => {
      target.classList.add('active');
      if (pageId === 'peta') {
        map.invalidateSize();
      }
    }, 10);
  }
}
function isiTombolJelajahi() {
  const cards = document.querySelectorAll('.gallery .card');

  const namaToLink = gunung.reduce((map, g) => {
    const namaBersih = g.nama.toLowerCase().replace("gunung ", "").trim();
    map[namaBersih] = g.link;
    return map;
  }, {});

  cards.forEach(card => {
    const pText = card.querySelector('p')?.textContent?.toLowerCase();
    const namaGunung = pText?.match(/gunung\s(.+?)\s\(/)?.[1]?.trim();
    const link = namaToLink[namaGunung];

    if (link) {
      const a = card.querySelector('a');
      a.setAttribute('href', link);
      a.setAttribute('target', '_blank');
      a.textContent = 'Lihat Detail';
    }
  });
}

window.addEventListener("DOMContentLoaded", isiTombolJelajahi);
